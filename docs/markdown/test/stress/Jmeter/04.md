# 四、配置压力测试并启动调优

## 4.1 配置参数

1. 修改压测的文件名称方便后续管理

![](/test/stress/Jmeter/011.png)

设置好后crtl+s保存，会提示保存一份jmx文件，请记住这份文件，保存好，以后在这次文件上设置好的参数，只要保存好了，都会保存在这份配置文件上，我们只要在jmeter工具上导入这份文件就可以获得设置好的参数，就不用重新去配置了，当然可以将这份文件传给需要使用jmeter压测的同事，他们导入jmeter后也可以直接使用


2. 配置jmeter的参数

![](/test/stress/Jmeter/012.png)

![](/test/stress/Jmeter/013.png)


>说明：
>1. 线程数：是指请求线程数量，一般我们叫他并发量，压测一开始可以不用设置那么高的并发量，根据实际情况来设置，本人需要压测的项目主要的性能指标是接口的吞吐量，所以我一开始是只设置了50，后面根据吞吐量慢慢把并发量加上去，观察吞吐量会不会有所变化
>2. 持续时间：是指压测运行的时间长度，一般压测几分钟就可以了，压测几分钟，吞吐量稳定后，就可以不用继续压测下去，这个主要用于观察接口的稳定性


3. 配置http请求

http请求是用于配置请求模式和请求的参数

![](/test/stress/Jmeter/014.png)

根据实际设置好参数，请求参数可以json字符串也可以kv值形式，跟postman有点类似，根据后端的接口来设置吧

![](/test/stress/Jmeter/015.png)

4. 其他配置

- 消息头管理器：配置系统请求的报文头，与HTTP请求配置类似

![](/test/stress/Jmeter/016.png)

- 察看结果树：观察请求接口返回的参数是否正常

![](/test/stress/Jmeter/017.png)

- 聚合报告：所有请求系统后，系统的响应处理时间、吞吐量的参数汇报

![](/test/stress/Jmeter/018.png)

- 图形结果：根据请求线程的情况，绘制的折线图

![](/test/stress/Jmeter/019.png)

- 添加的总条目

![](/test/stress/Jmeter/020.png)

## 4.2 压测

### 4.2.1 初始压测

1. 准备

配置参数后，保存参数crtl+s，点击下工具栏的清除按钮，将已经存在的请求返回结果清除下，记得每次运行压测时，都清除下，保证每一次压测的数据都是最新的

![](/test/stress/Jmeter/021.png)


2. 启动压测

如果只是针对一个接口进行压测，右击分组的线程组，点击启动就可以了，如果是想对本次页面上所有的线程组进行压测，可以点击工具栏的启动按钮，但是这种情况会将所有的线程组都同时启动，是测试多个接口的压测汇总的启动方式

![](/test/stress/Jmeter/022.png)

3. 是否请求成功

![](/test/stress/Jmeter/023.png)

4. 压测数据报告

![](/test/stress/Jmeter/024.png)

5. 停止启动

![](/test/stress/Jmeter/025.png)

### 4.2.2 混合压测

针对多个接口需要混合压测，就需要同时启动多个线程组，设置好线程组的参数后，点击工具栏的启动按钮，就可以看到每一个线程组都在进行着压测，可以观察每一个接口的实际压测情况


![](/test/stress/Jmeter/026.png)


### 4.2.3 导入压测配置文件


![](/test/stress/Jmeter/027.png)